import{G as V,T as q,aj as F,o as I,y as K,M as y,a as C,aN as H,S as J,V as Q,D as W,u as X,k as Y,am as Z,O as $,b as j}from"./GLTFLoader-Cpm_xSlR.js";import{R as ee,S as te,E as S}from"./EffectComposer-3ITbW_mG.js";import{O as ae}from"./OutputPass-Cb-qhM84.js";import{U as ne}from"./UnrealBloomPass-CnSu0yKn.js";import{d as se,f as oe,p as re,k as ie,w as le,q as de,o as ue,h as _}from"./index-qyBmO-yZ.js";import{a as ce}from"./_plugin-vue_export-helper-CQ7wvoWd.js";import"./Pass-8nf9LS6g.js";const me=1,pe=se({__name:"index",setup(fe){const E=new V;new q;let L,s,a,r,x,l,M,g;function O(){({container:L,renderer:s,scene:a,camera:r,clock:x,viewPort:l,tick:M}=X(document.querySelector(".webgl")))}function B(){r.position.set(0,0,10),s.toneMapping=Y,s.toneMappingExposure=1;const e=new Z(16777215,1);a.add(e)}function b(){g=new $(r,s.domElement),g.enableDamping=!0}function T(){le(l,()=>{const{width:e,height:t}=l.value;r.aspect=e/t,r.updateProjectionMatrix(),s.setSize(e,t,!1),n&&n.setSize(e,t),o&&o.setSize(e,t)})}let d;function U(){d=new j({container:document.querySelector(".debug")}),de(()=>d.destroy)}oe(()=>{O(),U(),b(),T(),B(),D(),k(),N(),z(),a.traverse(P),M(()=>{const e=x.getElapsedTime();c&&c.setTime(e),u.rotation.y=e*1.5,g.update(),a.traverse(P),n.render(),a.traverse(G),o.render()})});let c,v;function D(){E.loadAsync(new URL("/assets/fantasy_sword-KPv4lU3U.glb",import.meta.url).href).then(e=>{c=new F(e.scene),c.clipAction(e.animations[0]).play(),v=e.scene,a.add(v),v.traverse(i=>{i.isMesh&&i.name!=="背景"&&i.layers.toggle(me)})})}let u,m,p;function k(){u=new I;const e=new K(.2,32,32),t=new y({color:8556543});m=new C(e,t),m.position.x=-3,u.add(m);const i=t.clone();i.color.set(16753920),p=new C(e,i),u.add(p),p.position.x=3,a.add(u)}let w;function N(){w=new H,w.set(1),m.layers.toggle(1),p.layers.toggle(1)}let f={};const A=new y({color:0});function P(e){e.isMesh&&w.test(e.layers)===!1&&(f[e.uuid]=e.material,e.material=A)}function G(e){f[e.uuid]&&(e.material=f[e.uuid],delete f[e.uuid])}let h,o;function z(){h=new ee(a,r);const e=new ae;R();const t=new te(new J({uniforms:{tDiffuse:{value:null},bloomTexture:{value:n.renderTarget2.texture}},vertexShader:`
          varying vec2 vUv;
          void main() {
            vUv = uv;
            gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
          }
        `,fragmentShader:`
          uniform sampler2D tDiffuse;
          uniform sampler2D bloomTexture;
          varying vec2 vUv;
          void main() {
            gl_FragColor = ( texture2D( tDiffuse, vUv ) + vec4( 1. ) * texture2D( bloomTexture, vUv ) );
          }
        `}));o=new S(s),o.addPass(h),o.addPass(t),o.addPass(e)}let n;function R(){n=new S(s);const e=new ne(new Q(l.value.width,l.value.height),1.5,.4,.85);e.strength=.55,e.threshold=.1,e.radius=.1,n.addPass(h),n.addPass(e),n.renderToScreen=!1,d.add(e,"strength").min(0).max(2).step(.01).name("强度"),d.add(e,"threshold").min(0).max(2).step(.01).name("阈值"),d.add(e,"radius").min(0).max(2).step(.01).name("半径")}return(e,t)=>(ue(),re(W,null,{default:ie(()=>t[0]||(t[0]=[_("div",{class:"webgl"},null,-1),_("div",{class:"debug"},null,-1)])),_:1}))}}),ye=ce(pe,[["__scopeId","data-v-0b7c15e4"]]);export{ye as default};
